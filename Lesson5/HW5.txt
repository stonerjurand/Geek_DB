#Тема “Сложные запросы”

#Составьте список пользователей users, которые осуществили хотя бы один заказ orders в интернет магазине.

SELECT id, name FROM shop.users
WHERE id IN (SELECT DISTINCT user_id from shop.orders AS tmp);

#Выведите список товаров products и разделов catalogs, который соответствует товару.

SELECT 
products.id, 
products.name AS 'Товар',
catalogs.name AS 'Категория'
FROM products
INNER JOIN catalogs
ON catalog_id = catalogs.id;

#Тема “Транзакции, переменные, представления”

#В базе данных shop и sample присутствуют одни и те же таблицы, учебной базы данных. 
#Переместите запись id = 1 из таблицы shop.users в таблицу sample.users. Используйте транзакции.

START TRANSACTION;

INSERT INTO sample.users (name, birthday_at, created_at, updated_at)
SELECT name, birthday_at, created_at, updated_at FROM shop.users WHERE id = 1;

DELETE FROM shop.users WHERE id = 1;

COMMIT;

#Создайте представление, которое выводит название name товарной позиции из таблицы products 
#и соответствующее название каталога name из таблицы catalogs.

CREATE VIEW prod_cat AS
SELECT products.name AS 'Товар', 
catalogs.name AS 'Категория'
FROM products
INNER JOIN catalogs
ON catalog_id = catalogs.id;